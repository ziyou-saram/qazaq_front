{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/alikhanzhumabayev/Downloads/qazaq_full_project/frontend/apps/cms/src/lib/api.ts"],"sourcesContent":["import type { APIError, UserResponse } from \"./types\";\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\";\n\nclass APIClient {\n    private baseURL: string;\n    private accessToken?: string;\n\n    constructor(baseURL: string) {\n        this.baseURL = baseURL;\n    }\n\n    public setAccessToken(token: string) {\n        this.accessToken = token;\n    }\n\n    public async request<T>(endpoint: string, options?: RequestInit): Promise<T> {\n        const url = `${this.baseURL}${endpoint}`;\n\n        const headers: HeadersInit = {\n            ...options?.headers,\n        };\n\n        if (!(options?.body instanceof FormData)) {\n            (headers as Record<string, string>)[\"Content-Type\"] = \"application/json\";\n        }\n\n        if (this.accessToken) {\n            (headers as Record<string, string>)[\"Authorization\"] = `Bearer ${this.accessToken}`;\n        }\n\n        const response = await fetch(url, {\n            ...options,\n            headers,\n        });\n\n        if (!response.ok) {\n            const error: APIError | { detail: Array<{ loc: string[]; msg: string }> } =\n                await response.json().catch(() => ({\n                    detail: `HTTP ${response.status}: ${response.statusText}`,\n                }));\n\n            if (Array.isArray(error.detail)) {\n                const message = error.detail\n                    .map((item) => `${item.loc?.join(\".\") || \"field\"}: ${item.msg}`)\n                    .join(\"; \");\n                throw new Error(message);\n            }\n\n            throw new Error(error.detail);\n        }\n\n        return response.json();\n    }\n\n    public auth = {\n        login: (credentials: { email: string; password: string }) =>\n            this.request<{ access_token: string; refresh_token: string; token_type: string }>(\n                \"/auth/login\",\n                {\n                    method: \"POST\",\n                    body: JSON.stringify(credentials),\n                }\n            ),\n        register: (data: {\n            username: string;\n            email: string;\n            password: string;\n            first_name: string;\n            last_name: string;\n            role: \"editor\" | \"chief_editor\" | \"publishing_editor\" | \"moderator\" | \"user\";\n        }) =>\n            this.request<UserResponse>(\"/auth/register\", {\n                method: \"POST\",\n                body: JSON.stringify(data),\n            }),\n        me: (token?: string) => {\n            const headers: HeadersInit = {};\n            if (token) {\n                (headers as Record<string, string>)[\"Authorization\"] = `Bearer ${token}`\n            }\n            return this.request<UserResponse>(\"/auth/me\", { headers });\n        }\n    };\n\n    public media = {\n        upload: (file: File) => {\n            const formData = new FormData();\n            formData.append(\"file\", file);\n            return this.request<{ url: string }>(\"/media/upload\", {\n                method: \"POST\",\n                body: formData,\n            });\n        }\n    };\n}\n\nexport const api = new APIClient(API_URL);\n\nexport function resolveMediaUrl(path?: string | null) {\n    if (!path) return null;\n    if (path.startsWith(\"http\")) return path;\n    const baseUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\";\n    return `${baseUrl}${path}`;\n}\n\nexport async function getServerApi() {\n    const { cookies } = await import(\"next/headers\");\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"access_token\")?.value;\n\n    const serverApi = new APIClient(process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000\");\n\n    if (token) {\n        serverApi.setAccessToken(token);\n    }\n\n    return serverApi;\n}\n"],"names":[],"mappings":";;;;;;;;AAEA,MAAM,UAAU,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAEnD,MAAM;IACM,QAAgB;IAChB,YAAqB;IAE7B,YAAY,OAAe,CAAE;QACzB,IAAI,CAAC,OAAO,GAAG;IACnB;IAEO,eAAe,KAAa,EAAE;QACjC,IAAI,CAAC,WAAW,GAAG;IACvB;IAEA,MAAa,QAAW,QAAgB,EAAE,OAAqB,EAAc;QACzE,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,GAAG,UAAU;QAExC,MAAM,UAAuB;YACzB,GAAG,SAAS,OAAO;QACvB;QAEA,IAAI,CAAC,CAAC,SAAS,gBAAgB,QAAQ,GAAG;YACrC,OAAkC,CAAC,eAAe,GAAG;QAC1D;QAEA,IAAI,IAAI,CAAC,WAAW,EAAE;YACjB,OAAkC,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,EAAE;QACvF;QAEA,MAAM,WAAW,MAAM,MAAM,KAAK;YAC9B,GAAG,OAAO;YACV;QACJ;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,QACF,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;oBAC/B,QAAQ,CAAC,KAAK,EAAE,SAAS,MAAM,CAAC,EAAE,EAAE,SAAS,UAAU,EAAE;gBAC7D,CAAC;YAEL,IAAI,MAAM,OAAO,CAAC,MAAM,MAAM,GAAG;gBAC7B,MAAM,UAAU,MAAM,MAAM,CACvB,GAAG,CAAC,CAAC,OAAS,GAAG,KAAK,GAAG,EAAE,KAAK,QAAQ,QAAQ,EAAE,EAAE,KAAK,GAAG,EAAE,EAC9D,IAAI,CAAC;gBACV,MAAM,IAAI,MAAM;YACpB;YAEA,MAAM,IAAI,MAAM,MAAM,MAAM;QAChC;QAEA,OAAO,SAAS,IAAI;IACxB;IAEO,OAAO;QACV,OAAO,CAAC,cACJ,IAAI,CAAC,OAAO,CACR,eACA;gBACI,QAAQ;gBACR,MAAM,KAAK,SAAS,CAAC;YACzB;QAER,UAAU,CAAC,OAQP,IAAI,CAAC,OAAO,CAAe,kBAAkB;gBACzC,QAAQ;gBACR,MAAM,KAAK,SAAS,CAAC;YACzB;QACJ,IAAI,CAAC;YACD,MAAM,UAAuB,CAAC;YAC9B,IAAI,OAAO;gBACN,OAAkC,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;YAC5E;YACA,OAAO,IAAI,CAAC,OAAO,CAAe,YAAY;gBAAE;YAAQ;QAC5D;IACJ,EAAE;IAEK,QAAQ;QACX,QAAQ,CAAC;YACL,MAAM,WAAW,IAAI;YACrB,SAAS,MAAM,CAAC,QAAQ;YACxB,OAAO,IAAI,CAAC,OAAO,CAAkB,iBAAiB;gBAClD,QAAQ;gBACR,MAAM;YACV;QACJ;IACJ,EAAE;AACN;AAEO,MAAM,MAAM,IAAI,UAAU;AAE1B,SAAS,gBAAgB,IAAoB;IAChD,IAAI,CAAC,MAAM,OAAO;IAClB,IAAI,KAAK,UAAU,CAAC,SAAS,OAAO;IACpC,MAAM,UAAU,QAAQ,GAAG,CAAC,mBAAmB,IAAI;IACnD,OAAO,GAAG,UAAU,MAAM;AAC9B;AAEO,eAAe;IAClB,MAAM,EAAE,OAAO,EAAE,GAAG;IACpB,MAAM,cAAc,MAAM;IAC1B,MAAM,QAAQ,YAAY,GAAG,CAAC,iBAAiB;IAE/C,MAAM,YAAY,IAAI,UAAU,QAAQ,GAAG,CAAC,mBAAmB,IAAI;IAEnE,IAAI,OAAO;QACP,UAAU,cAAc,CAAC;IAC7B;IAEA,OAAO;AACX"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///Users/alikhanzhumabayev/Downloads/qazaq_full_project/frontend/apps/cms/src/actions/auth.ts"],"sourcesContent":["'use server'\n\nimport { cookies } from 'next/headers'\nimport { redirect } from 'next/navigation'\nimport { api } from '@/lib/api'\n\nexport async function login(prevState: any, formData: FormData) {\n    const email = formData.get('email') as string\n    const password = formData.get('password') as string\n\n    try {\n        const response = await api.auth.login({ email, password })\n\n        const cookieStore = await cookies()\n        cookieStore.set('access_token', response.access_token, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            maxAge: 60 * 60 * 24 * 7, // 1 week\n            path: '/',\n        })\n\n        cookieStore.set('refresh_token', response.refresh_token, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            maxAge: 60 * 60 * 24 * 30, // 30 days\n            path: '/',\n        })\n\n    } catch (error) {\n        return { error: 'Неверный email или пароль' }\n    }\n\n    redirect('/cms/dashboard')\n}\n\nexport async function logout() {\n    const cookieStore = await cookies()\n    cookieStore.delete('access_token')\n    cookieStore.delete('refresh_token')\n    redirect('/login')\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AACA;;;;;;AAEO,eAAe,MAAM,SAAc,EAAE,QAAkB;IAC1D,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;IAE9B,IAAI;QACA,MAAM,WAAW,MAAM,uIAAG,CAAC,IAAI,CAAC,KAAK,CAAC;YAAE;YAAO;QAAS;QAExD,MAAM,cAAc,MAAM,IAAA,0IAAO;QACjC,YAAY,GAAG,CAAC,gBAAgB,SAAS,YAAY,EAAE;YACnD,UAAU;YACV,QAAQ,oDAAyB;YACjC,QAAQ,KAAK,KAAK,KAAK;YACvB,MAAM;QACV;QAEA,YAAY,GAAG,CAAC,iBAAiB,SAAS,aAAa,EAAE;YACrD,UAAU;YACV,QAAQ,oDAAyB;YACjC,QAAQ,KAAK,KAAK,KAAK;YACvB,MAAM;QACV;IAEJ,EAAE,OAAO,OAAO;QACZ,OAAO;YAAE,OAAO;QAA4B;IAChD;IAEA,IAAA,iMAAQ,EAAC;AACb;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,MAAM,CAAC;IACnB,YAAY,MAAM,CAAC;IACnB,IAAA,iMAAQ,EAAC;AACb;;;IAlCsB;IA6BA;;AA7BA,+OAAA;AA6BA,+OAAA"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///Users/alikhanzhumabayev/Downloads/qazaq_full_project/frontend/apps/cms/.next-internal/server/app/login/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {login as '60b13457ed6f7bb6eaaab8a58962fbe0a3181f6479'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}